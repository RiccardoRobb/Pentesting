# Basics to Pentesting

---

## NMAP

* **Scan for open ports**
  
  `nmap -sV {IP}` or `namp -p- {IP}`
  
  `-sV` allows to perform version detection
  
  `-sC` allows to run safe script that can help for version detection
  
  We can speedup the scan using `--min-rate {RATE}` or `-T{RATE}`

* **Identify service on port**
  
  `nmap -p23 {IP}`
  
  As we can see `23/tcp telnet open` so we can try to connect to the machine using telnet.

---

## TELNET

* **Connect using telnet**
  
  `telnet {IP}`
  
  For the login we can try generally used usernames, such as *admin*, *administrator* or *root*.

---

## FTP

* **Login as guest (no psw)**
  
  `ftp {IP}`
  
  Use *anonymous* as username.

* **Using the `get` command we can directly download a file**

---

## SMB (server message block)

Protocol used by Microsoft Windows systems, allows to share files, printers and serial ports ... (authenticated process communication)

* **List shares on target**
  
  `smbclient -L {IP}`

* **Connect to machine**
  
  `smbclient //{IP}/{DRIVE} -U {USERNAME}`

* **FTP-like commends, such as `put` or `get`**

---

## REDIS

Is an In-memory Database used as database, cache, and message broker

* **Connect to Redis**
  
  `redis-cli -h {IP}`

* **Get redis `info`**

* **Get list of databases**
  
  `info keyspace`

* **Get value from keys**
  
  List all keys in database: `keys *`
  
  Get content from key: `get {KEY}`

---

## MONGODB

* **Connect to remote DB**
  
  `./mongo mongodb://{IP}:{PORT}`

* **List databases `show dbs`**

* **List collections in db `use {DB}` and `show collections`**

* **Dump content of interesting collections**
  
  `db.{COLLECTION}.find().pretty()`

---

## MYSQL

* **Connect to remote DB**
  
  `mysql -u {USER} -h {IP} -p {PSW}`
  
  For MariaDB we can use *root* for user (does not require a psw)

---

## RDP (remote desktop protocol)

Protocol used from GUI in Windows Systems

* **Connect to remote host**
  
  `xfreerdp /v:{IP} /u:{USERNAME}`
  
  *administrator* can be useful (does not require a psw)

---

## RSYNC

Allows to sync files and directories from and to different hosts

To connect using anonymous authentication we can use *None*

* **List files**
  
  `rsync --list-only None@{IP}::`

* **Get files**
  
  `rsync None@{IP}::{REMOTEPATH} {LOCALPATH}`

---

---

# Responder

Is a useful tool that can do many different kinds of attacks. 

* **Setup a SQL server**

* **Setup a  SMB server**

Using Responder we can catch responses from services directly on our machine

---

---

# Dir Busting

Directory brute-forcing is a technique used to check a lot of paths on a web server

SecLists: [SecLists](https://github.com/danielmiessler/SecLists)

Practicing: [Damn Vulnerable Web Application (DVWA)](https://github.com/digininja/DVWA)

## Gobuster

* `gobuster -m dir -u {IP} -w {LIST} -x {FILETYTPETARGET}`

---

---

# Name-Based Virtual hosting

Is a method for hosting multiple domain names on a single server.

The web server checks the domain name provided in the *Host* header field of the HTTP request and sends a response.

> A target Website can redirect to a new Website, and this Website can be unreachable

In order to resolve a *Hostname* into an *IP address* we can:

* **Add a new entry in `/etc/hosts`**
  
  `echo "{IP} {WEBSITENAME}" | sudo tee -a /etc/hosts`

---

---

# Local & Remote File inclusion

## Local

Happens when an application uses the path to a file as an input.

If the application treats this input as trusted, and the required sanitary checks are not performed on this input, then the attacker can exploit it by using the `../` string in the inputted file name. *LFI* can lead to code execution as well.

## Remote

Happens when an attacker loads a remote file on the host using *HTTP*, *FTP* ....

For a good *RFI* we can try to inject particular paths in the *URL*, based on the Webserver used. 

For Windows based systems we can try: 

* `../../../../../../../../windows/system32/drivers/etc/hosts`
  
  This type of attack works if the content of the *PHP* functions is not correctly sanitized, see `include()` function.

Known paths: [Auto_WordLists](https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt)

---

---

# Pentest phases:

## 1- Scan for open ports

## 2- Analyze open ports to see which service can be used

## 3- Try to do Dir Busting to find useful files

---

Sources: [HackTricks](https://book.hacktricks.xyz/welcome/readme), [Hack The Box](https://app.hackthebox.com/starting-point) and others

@Author: [RiccardoRobb (Robb) Â· GitHub](https://github.com/RiccardoRobb)